"use strict";(self.webpackChunkysw_kr=self.webpackChunkysw_kr||[]).push([[772],{7021:(e,t,r)=>{r.d(t,{Fc:()=>u,TN:()=>d});var n=r(6540),a=r(2732),l=r(884);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const i=(0,a.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function u(e){var{className:t,variant:r}=e,a=s(e,["className","variant"]);return n.createElement("div",c({"data-slot":"alert",role:"alert",className:(0,l.cn)(i({variant:r}),t)},a))}function d(e){var{className:t}=e,r=s(e,["className"]);return n.createElement("div",c({"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t)},r))}},3303:(e,t,r)=>{r.d(t,{$:()=>u});var n=r(6540),a=r(3362),l=r(2732),o=r(884);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){var{className:t,variant:r,size:l,asChild:u=!1}=e,d=s(e,["className","variant","size","asChild"]);const m=u?a.DX:"button";return n.createElement(m,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){c(e,t,r[t])}))}return e}({"data-slot":"button",className:(0,o.cn)(i({variant:r,size:l,className:t}))},d))}},9325:(e,t,r)=>{r.d(t,{BT:()=>d,Wu:()=>m,ZB:()=>u,Zp:()=>s,aR:()=>i,wL:()=>f});var n=r(6540),a=r(884);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){l(e,t,r[t])}))}return e}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function s(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t)},r))}function i(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card-header",className:(0,a.cn)("flex flex-col gap-1.5 px-6",t)},r))}function u(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t)},r))}function d(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t)},r))}function m(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card-content",className:(0,a.cn)("px-6",t)},r))}function f(e){var{className:t}=e,r=c(e,["className"]);return n.createElement("div",o({"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6",t)},r))}},884:(e,t,r)=>{r.d(t,{cn:()=>l,v:()=>o});var n=r(4164),a=r(856);function l(...e){return(0,a.QP)((0,n.$)(e))}function o(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(2))} ${["Bytes","KB","MB","GB"][t]}`}},8384:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(6540),a=r(9325),l=r(7200),o=r(5107),c=r(5773),s=r(2102),i=r(884);function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}function m(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){u(e,t,r[t])}))}return e}function g(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function p(e){var t=d({},m(e));return n.createElement(l.bL,f({"data-slot":"select"},t))}function v(e){var t=d({},m(e));return n.createElement(l.WT,f({"data-slot":"select-value"},t))}function b(e){var{className:t,size:r="default",children:a}=e,c=g(e,["className","size","children"]);return n.createElement(l.l9,f({"data-slot":"select-trigger","data-size":r,className:(0,i.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},c),a,n.createElement(l.In,{asChild:!0},n.createElement(o.A,{className:"size-4 opacity-50"})))}function h(e){var{className:t,children:r,position:a="popper"}=e,o=g(e,["className","children","position"]);return n.createElement(l.ZL,null,n.createElement(l.UC,f({"data-slot":"select-content",className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a},o),n.createElement(E,null),n.createElement(l.LM,{className:(0,i.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1")},r),n.createElement(x,null)))}function y(e){var{className:t,children:r}=e,a=g(e,["className","children"]);return n.createElement(l.q7,f({"data-slot":"select-item",className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t)},a),n.createElement("span",{className:"absolute right-2 flex size-3.5 items-center justify-center"},n.createElement(l.VF,null,n.createElement(c.A,{className:"size-4"}))),n.createElement(l.p4,null,r))}function E(e){var{className:t}=e,r=g(e,["className"]);return n.createElement(l.PP,f({"data-slot":"select-scroll-up-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t)},r),n.createElement(s.A,{className:"size-4"}))}function x(e){var{className:t}=e,r=g(e,["className"]);return n.createElement(l.wn,f({"data-slot":"select-scroll-down-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",t)},r),n.createElement(o.A,{className:"size-4"}))}var w=r(3303),N=r(8614),k=r(5977),S=r(8240),O=r(8834),R=r(5731),j=r(690),P=r(7021),A=r(9949),C=r(7831);const z=n.memo((({url:e,onReady:t,isRecording:r,audioStream:a,setIsPlaying:l,audioRef:o})=>{const c=(0,n.useRef)(null),s=(0,n.useRef)(null),i=(0,n.useRef)(null),u=(0,n.useRef)(null),d=(0,n.useRef)(null),m=(0,n.useRef)(null),f=(0,n.useRef)(null),g=(0,n.useRef)(0),p=(0,n.useRef)(null);(0,n.useEffect)((()=>(r&&a&&(console.log("Setting up live visualization for recording"),u.current&&(u.current.close(),d.current=null,f.current=null),g.current=Date.now(),u.current=new AudioContext,d.current=u.current.createAnalyser(),f.current=u.current.createMediaStreamSource(a),d.current.fftSize=2048,d.current.smoothingTimeConstant=.8,f.current.connect(d.current),requestAnimationFrame(v),console.log("Audio visualization pipeline created")),()=>{f.current&&(f.current.disconnect(),f.current=null),u.current&&(u.current.close(),u.current=null),m.current&&(cancelAnimationFrame(m.current),m.current=null)})),[r,a]);const v=(0,n.useCallback)((()=>{if(!d.current||!i.current||!r)return;const e=i.current,t=e.getContext("2d");if(!t)return;const n=e.width,a=e.height,l=d.current.frequencyBinCount,o=new Float32Array(l);d.current.getFloatTimeDomainData(o);const c=o.reduce(((e,t)=>e+Math.abs(t)),0)/l,s=Math.min(2*c,1);t.fillStyle="white",t.fillRect(0,0,n,a);const u=t.createLinearGradient(0,0,0,a);u.addColorStop(0,"rgba(0, 0, 0, 0.05)"),u.addColorStop(1,"rgba(0, 0, 0, 0.1)"),t.fillStyle=u,t.fillRect(0,0,n,a);const f=n*s,p=t.createLinearGradient(0,0,f,0);p.addColorStop(0,"#6366f1"),p.addColorStop(1,"#8b5cf6"),t.fillStyle=p,t.fillRect(0,0,f,a);const b=(Date.now()-g.current)/1e3,h=Math.min(b/10,1);t.fillStyle="rgba(0, 0, 0, 0.2)",t.fillRect(n*h,0,2,a),r&&(m.current=requestAnimationFrame(v))}),[r]);return(0,n.useEffect)((()=>{if(!c.current||r)return;s.current&&s.current.destroy();const e=A.A.create({container:c.current,waveColor:"#4f46e5",progressColor:"#4338ca",barWidth:4,barRadius:3,height:100,barGap:4,normalize:!0,barHeight:.8,backend:"MediaElement",interact:!0,cursorWidth:0,hideScrollbar:!0});return e.on("ready",(()=>{console.log("WaveSurfer is ready, duration:",e.getDuration()),t()})),e.on("audioprocess",(t=>{console.log("Audioprocess event triggered:",t);const r=e.getDuration(),n=c.current,a=p.current;if(console.log("Time update:",{time:t,duration:r,container:n,cursor:a}),!n||!a||0===r)return void console.warn("Cursor movement skipped:",{container:n,cursor:a,duration:r});const l=n.offsetWidth*Math.min(t/r,1);requestAnimationFrame((()=>{a.style.transform=`translateX(${l}px)`}))})),e.on("play",(()=>{console.log("WaveSurfer: Play started")})),e.on("pause",(()=>{console.log("WaveSurfer: Play paused")})),e.on("finish",(()=>{console.log("WaveSurfer: Playback finished"),e.pause(),e.seekTo(0),p.current&&(p.current.style.transform="translateX(0)"),l(!1)})),e.on("error",(e=>{console.error("WaveSurfer error:",e)})),s.current=e,()=>{e.destroy()}}),[t,r]),(0,n.useEffect)((()=>(o.current&&(o.current.onended=()=>{console.log("Audio element: Playback finished"),l(!1)},o.current.ontimeupdate=()=>{if(!o.current||!p.current)return;const{currentTime:e,duration:t}=o.current,r=c.current;if(!r)return;const n=r.offsetWidth*Math.min(e/t,1);requestAnimationFrame((()=>{p.current&&(p.current.style.transform=`translateX(${n}px)`)}))}),()=>{o.current&&(o.current.onended=null,o.current.ontimeupdate=null)})),[]),(0,n.useEffect)((()=>{s.current&&e&&!r&&(console.log("Loading audio into WaveSurfer:",e),s.current.load(e))}),[e,r]),n.createElement("div",{className:"w-full rounded-lg overflow-visible bg-gray-100 p-4",style:{minHeight:"100px"}},r?n.createElement("div",{className:"flex flex-col gap-4"},n.createElement("div",{className:"flex items-center gap-2 text-indigo-600"},n.createElement("div",{className:"relative"},n.createElement(N.A,{className:"w-5 h-5 animate-pulse"}),n.createElement("div",{className:"absolute inset-0 rounded-full ring-2 ring-indigo-500/50 animate-ping"})),n.createElement("span",{className:"text-sm font-medium"},"Recording in progress...")),n.createElement("canvas",{ref:i,width:800,height:40,className:"w-full h-10 rounded-lg shadow-inner"}),n.createElement("div",{className:"text-xs text-gray-500 text-center"},"Speak into your microphone to see the volume level")):n.createElement("div",{className:"relative",style:{minHeight:"100px"}},n.createElement("div",{ref:p,className:"absolute top-0 bottom-0 w-[2px] bg-red-500",style:{transform:"translateX(0)",zIndex:10,transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}}),n.createElement("div",{ref:c})))}));function T(){const[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(""),[s,i]=(0,n.useState)(""),[u,d]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[g,E]=(0,n.useState)(""),[x,A]=(0,n.useState)(!0),[T,F]=(0,n.useState)(!1),[D,I]=(0,n.useState)(!1),[M,B]=(0,n.useState)(null),W=(0,n.useRef)(null),_=(0,n.useRef)(null),L=(0,n.useRef)([]),$=(0,n.useRef)(null),Z=(0,n.useRef)(null),q=(0,n.useRef)(null),U=(0,n.useCallback)((()=>{console.log("Waveform ready callback"),I(!0)}),[]);(0,n.useEffect)((()=>{G()}),[]);const G=async()=>{A(!0),B(null);try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach((e=>e.stop())),l(!0),await V()}catch(M){console.error("Error requesting permissions:",M),B("Could not access microphone. Please check your permissions.")}finally{A(!1)}},V=async()=>{try{const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind||"audiooutput"===e.kind));t(e);const r=e.find((e=>"audioinput"===e.kind)),n=e.find((e=>"audiooutput"===e.kind));r&&c(r.deviceId),n&&i(n.deviceId)}catch(M){console.error("Error updating device list:",M),B("Could not enumerate audio devices.")}},X=()=>{console.log("Stopping recording..."),W.current&&u&&(W.current.requestData(),W.current.stop(),d(!1),console.log("Recording stopped"))};return x?n.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},n.createElement("div",{className:"flex items-center justify-center h-[60vh]"},"Please grant permission to access your microphone and speakers.",n.createElement(k.A,{className:"h-8 w-8 animate-spin text-primary"}))):r?n.createElement(C.A,{title:"Audio Device Checker"},n.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},n.createElement("h1",{className:"text-3xl font-bold mb-8"},"Audio Device Checker"),M&&n.createElement(P.Fc,{className:"mb-6 bg-red-50 border-red-200"},n.createElement(P.TN,{className:"text-red-800"},M)),n.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},n.createElement(a.Zp,null,n.createElement(a.aR,null,n.createElement(a.ZB,{className:"flex items-center gap-2"},n.createElement(N.A,{className:"h-5 w-5"}),"Microphones"),n.createElement(a.BT,null,"Select the microphone you want to test")),n.createElement(a.Wu,null,n.createElement(p,{value:o,onValueChange:c},n.createElement(b,null,n.createElement(v,{placeholder:"Select a microphone"})),n.createElement(h,null,e.filter((e=>"audioinput"===e.kind)).map((e=>n.createElement(y,{key:e.deviceId,value:e.deviceId},e.label||`Microphone ${e.deviceId.substring(0,5)}...`))))))),n.createElement(a.Zp,null,n.createElement(a.aR,null,n.createElement(a.ZB,{className:"flex items-center gap-2"},n.createElement(S.A,{className:"h-5 w-5"}),"Speakers"),n.createElement(a.BT,null,"Select the speaker for playback")),n.createElement(a.Wu,null,n.createElement(p,{value:s,onValueChange:i},n.createElement(b,null,n.createElement(v,{placeholder:"Select a speaker"})),n.createElement(h,null,e.filter((e=>"audiooutput"===e.kind)).map((e=>n.createElement(y,{key:e.deviceId,value:e.deviceId},e.label||`Speaker ${e.deviceId.substring(0,5)}...`)))))),n.createElement(a.wL,null,n.createElement(w.$,{variant:T?"destructive":"default",onClick:async()=>{if(T)return $.current&&($.current.pause(),$.current.currentTime=0),void F(!1);try{B(null);const e=new Audio("https://li.me.kr/assets/audio/bgm.ogg");$.current=e,s&&e.setSinkId&&await e.setSinkId(s),e.play(),F(!0),e.onended=()=>{F(!1)}}catch(M){console.error("Error testing speaker:",M),B("Failed to test speaker. Please check your audio settings.")}},className:"flex items-center gap-2"},T?n.createElement(n.Fragment,null,n.createElement(O.A,{className:"h-4 w-4"}),"Stop Speaker Test"):n.createElement(n.Fragment,null,n.createElement(S.A,{className:"h-4 w-4"}),"Test Speaker"))))),n.createElement(a.Zp,null,n.createElement(a.aR,null,n.createElement(a.ZB,null,"Test Recording"),n.createElement(a.BT,null,"Record audio from your selected microphone and play it back through your selected speaker")),n.createElement(a.Wu,null,n.createElement("div",{className:"flex flex-col gap-4"},n.createElement("div",{className:"flex flex-wrap gap-4"},n.createElement(w.$,{variant:u?"destructive":"default",onClick:u?X:async()=>{try{B(null),g&&(URL.revokeObjectURL(g),E("")),f(!1),q.current&&(q.current.pause(),q.current.seekTo(0)),L.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:{deviceId:o,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1,sampleRate:44100,sampleSize:16}}),t=e.getAudioTracks();if(0===t.length)throw new Error("No audio track available");const r=t[0];if("live"!==r.readyState)throw new Error("Audio track is not live");r.onended=()=>{console.error("Audio track ended unexpectedly"),B("Audio track ended unexpectedly"),X()},r.onmute=()=>{console.error("Audio track muted"),B("Audio track was muted")},_.current=e,console.log("Got media stream:",e),console.log("Stream active:",e.active),console.log("Audio tracks:",t),console.log("Audio track settings:",r.getSettings());const n=new MediaRecorder(e,{mimeType:"audio/webm"});W.current=n,n.ondataavailable=e=>{e.data.size>0&&(L.current.push(e.data),console.log("Received audio chunk:",e.data.size,"bytes"),console.log("Total chunks:",L.current.length),console.log("Total size:",L.current.reduce(((e,t)=>e+t.size),0),"bytes"))},n.onstop=()=>{const t=new Blob(L.current,{type:"audio/webm"}),r=URL.createObjectURL(t);console.log("Created audio URL:",r),console.log("Final blob size:",t.size,"bytes"),E(r),e.getTracks().forEach((e=>{e.stop(),e.onended=null,e.onmute=null})),_.current=null},n.start(),console.log("MediaRecorder started"),d(!0),await new Promise((e=>setTimeout(e,100)))}catch(M){console.error("Error starting recording:",M),B(`Failed to start recording: ${M.message}`),_.current&&(_.current.getTracks().forEach((e=>e.stop())),_.current=null)}},disabled:!o,className:"flex items-center gap-2 transition-all duration-200 "+(u?"bg-red-600 hover:bg-red-700":"hover:bg-indigo-700")},u?n.createElement(n.Fragment,null,n.createElement(O.A,{className:"w-4 h-4"}),"Stop Recording"):n.createElement(n.Fragment,null,n.createElement(N.A,{className:"w-4 h-4"}),g?"Record Again":"Start Recording")),g&&!u&&n.createElement(n.Fragment,null,n.createElement(w.$,{variant:m?"destructive":"default",onClick:m?()=>{console.log("Stopping playback..."),Z.current&&(Z.current.pause(),Z.current.currentTime=0,f(!1))}:()=>{if(!g||u)return console.error("Cannot play: Recording in progress"),void B("Cannot play recording at this time");console.log("Playing recording..."),Z.current&&(Z.current.src=g,Z.current.play(),f(!0))},disabled:!D,className:"flex items-center gap-2 transition-all duration-200 "+(m?"bg-red-600 hover:bg-red-700":"hover:bg-indigo-700")},m?n.createElement(n.Fragment,null,n.createElement(O.A,{className:"w-4 h-4"}),"Stop Playback"):n.createElement(n.Fragment,null,n.createElement(R.A,{className:"w-4 h-4"}),"Play Recording")),n.createElement(w.$,{variant:"outline",onClick:()=>{if(g){const e=document.createElement("a");e.href=g,e.download="audio-recording.webm",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},className:"flex items-center gap-2 hover:bg-gray-100 transition-colors duration-200"},n.createElement(j.A,{className:"w-4 h-4"}),"Download Recording"))),!o&&n.createElement("div",{className:"text-sm text-gray-500 mt-2"},"Please select a microphone to start recording"),(g||u)&&n.createElement("div",{className:"mt-4"},n.createElement(z,{url:g,onReady:U,isRecording:u,audioStream:_.current||void 0,setIsPlaying:f,audioRef:Z}),n.createElement(P.Fc,{className:"mt-4"},n.createElement(P.TN,null,u?"Recording in progress... Speak into your microphone to see the volume level.":m?"Playing your recording...":"Recording is ready for playback. Click the play button to hear your recording.")))))),n.createElement("audio",{ref:Z,style:{display:"none"}}))):n.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},n.createElement("h1",{className:"text-3xl font-bold mb-8"},"Audio Device Checker"),n.createElement(a.Zp,null,n.createElement(a.aR,null,n.createElement(a.ZB,null,"Permission Required"),n.createElement(a.BT,null,"This tool needs permission to access your microphone and speakers.")),n.createElement(a.wL,null,n.createElement(w.$,{onClick:G},"Grant Permission"))))}z.displayName="Waveform"}}]);