"use strict";(self.webpackChunkysw_kr=self.webpackChunkysw_kr||[]).push([[772],{7021:(e,t,r)=>{r.d(t,{Fc:()=>u,TN:()=>d});var a=r(6540),n=r(2732),l=r(8231);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){o(e,t,r[t])}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const i=(0,n.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function u(e){var{className:t,variant:r}=e,n=s(e,["className","variant"]);return a.createElement("div",c({"data-slot":"alert",role:"alert",className:(0,l.cn)(i({variant:r}),t)},n))}function d(e){var{className:t}=e,r=s(e,["className"]);return a.createElement("div",c({"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t)},r))}},8771:(e,t,r)=>{r.d(t,{bq:()=>v,eb:()=>b,gC:()=>h,l6:()=>p,yv:()=>f});var a=r(6540),n=r(7200),l=r(5107),o=r(5773),c=r(2102),s=r(8231);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u.apply(this,arguments)}function d(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){i(e,t,r[t])}))}return e}function g(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function p(e){var t=u({},d(e));return a.createElement(n.bL,m({"data-slot":"select"},t))}function f(e){var t=u({},d(e));return a.createElement(n.WT,m({"data-slot":"select-value"},t))}function v(e){var{className:t,size:r="default",children:o}=e,c=g(e,["className","size","children"]);return a.createElement(n.l9,m({"data-slot":"select-trigger","data-size":r,className:(0,s.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},c),o,a.createElement(n.In,{asChild:!0},a.createElement(l.A,{className:"size-4 opacity-50"})))}function h(e){var{className:t,children:r,position:l="popper"}=e,o=g(e,["className","children","position"]);return a.createElement(n.ZL,null,a.createElement(n.UC,m({"data-slot":"select-content",className:(0,s.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l},o),a.createElement(y,null),a.createElement(n.LM,{className:(0,s.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1")},r),a.createElement(E,null)))}function b(e){var{className:t,children:r}=e,l=g(e,["className","children"]);return a.createElement(n.q7,m({"data-slot":"select-item",className:(0,s.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t)},l),a.createElement("span",{className:"absolute right-2 flex size-3.5 items-center justify-center"},a.createElement(n.VF,null,a.createElement(o.A,{className:"size-4"}))),a.createElement(n.p4,null,r))}function y(e){var{className:t}=e,r=g(e,["className"]);return a.createElement(n.PP,m({"data-slot":"select-scroll-up-button",className:(0,s.cn)("flex cursor-default items-center justify-center py-1",t)},r),a.createElement(c.A,{className:"size-4"}))}function E(e){var{className:t}=e,r=g(e,["className"]);return a.createElement(n.wn,m({"data-slot":"select-scroll-down-button",className:(0,s.cn)("flex cursor-default items-center justify-center py-1",t)},r),a.createElement(l.A,{className:"size-4"}))}},9754:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var a=r(6540),n=r(9325),l=r(8771),o=r(3303),c=r(8614),s=r(5977),i=r(8240),u=r(8834),d=r(5731),m=r(690),g=r(7021),p=r(9949),f=r(7831);const v=a.memo((({url:e,onReady:t,isRecording:r,audioStream:n,setIsPlaying:l,audioRef:o})=>{const s=(0,a.useRef)(null),i=(0,a.useRef)(null),u=(0,a.useRef)(null),d=(0,a.useRef)(null),m=(0,a.useRef)(null),g=(0,a.useRef)(null),f=(0,a.useRef)(null),v=(0,a.useRef)(0),h=(0,a.useRef)(null);(0,a.useEffect)((()=>(r&&n&&(console.log("Setting up live visualization for recording"),d.current&&(d.current.close(),m.current=null,f.current=null),v.current=Date.now(),d.current=new AudioContext,m.current=d.current.createAnalyser(),f.current=d.current.createMediaStreamSource(n),m.current.fftSize=2048,m.current.smoothingTimeConstant=.8,f.current.connect(m.current),requestAnimationFrame(b),console.log("Audio visualization pipeline created")),()=>{f.current&&(f.current.disconnect(),f.current=null),d.current&&(d.current.close(),d.current=null),g.current&&(cancelAnimationFrame(g.current),g.current=null)})),[r,n]);const b=(0,a.useCallback)((()=>{if(!m.current||!u.current||!r)return;const e=u.current,t=e.getContext("2d");if(!t)return;const a=e.width,n=e.height,l=m.current.frequencyBinCount,o=new Float32Array(l);m.current.getFloatTimeDomainData(o);const c=o.reduce(((e,t)=>e+Math.abs(t)),0)/l,s=Math.min(2*c,1);t.fillStyle="white",t.fillRect(0,0,a,n);const i=t.createLinearGradient(0,0,0,n);i.addColorStop(0,"rgba(0, 0, 0, 0.05)"),i.addColorStop(1,"rgba(0, 0, 0, 0.1)"),t.fillStyle=i,t.fillRect(0,0,a,n);const d=a*s,p=t.createLinearGradient(0,0,d,0);p.addColorStop(0,"#6366f1"),p.addColorStop(1,"#8b5cf6"),t.fillStyle=p,t.fillRect(0,0,d,n);const f=(Date.now()-v.current)/1e3,h=Math.min(f/10,1);t.fillStyle="rgba(0, 0, 0, 0.2)",t.fillRect(a*h,0,2,n),r&&(g.current=requestAnimationFrame(b))}),[r]);return(0,a.useEffect)((()=>{if(!s.current||r)return;i.current&&i.current.destroy();const e=p.A.create({container:s.current,waveColor:"#4f46e5",progressColor:"#4338ca",barWidth:4,barRadius:3,height:100,barGap:4,normalize:!0,barHeight:.8,backend:"MediaElement",interact:!0,cursorWidth:0,hideScrollbar:!0});return e.on("ready",(()=>{console.log("WaveSurfer is ready, duration:",e.getDuration()),t()})),e.on("audioprocess",(t=>{console.log("Audioprocess event triggered:",t);const r=e.getDuration(),a=s.current,n=h.current;if(console.log("Time update:",{time:t,duration:r,container:a,cursor:n}),!a||!n||0===r)return void console.warn("Cursor movement skipped:",{container:a,cursor:n,duration:r});const l=a.offsetWidth*Math.min(t/r,1);requestAnimationFrame((()=>{n.style.transform=`translateX(${l}px)`}))})),e.on("play",(()=>{console.log("WaveSurfer: Play started")})),e.on("pause",(()=>{console.log("WaveSurfer: Play paused")})),e.on("finish",(()=>{console.log("WaveSurfer: Playback finished"),e.pause(),e.seekTo(0),h.current&&(h.current.style.transform="translateX(0)"),l(!1)})),e.on("error",(e=>{console.error("WaveSurfer error:",e)})),i.current=e,()=>{e.destroy()}}),[t,r]),(0,a.useEffect)((()=>(o.current&&(o.current.onended=()=>{console.log("Audio element: Playback finished"),l(!1)},o.current.ontimeupdate=()=>{if(!o.current||!h.current)return;const{currentTime:e,duration:t}=o.current,r=s.current;if(!r)return;const a=r.offsetWidth*Math.min(e/t,1);requestAnimationFrame((()=>{h.current&&(h.current.style.transform=`translateX(${a}px)`)}))}),()=>{o.current&&(o.current.onended=null,o.current.ontimeupdate=null)})),[]),(0,a.useEffect)((()=>{i.current&&e&&!r&&(console.log("Loading audio into WaveSurfer:",e),i.current.load(e))}),[e,r]),a.createElement("div",{className:"w-full rounded-lg overflow-visible bg-gray-100 p-4",style:{minHeight:"100px"}},r?a.createElement("div",{className:"flex flex-col gap-4"},a.createElement("div",{className:"flex items-center gap-2 text-indigo-600"},a.createElement("div",{className:"relative"},a.createElement(c.A,{className:"w-5 h-5 animate-pulse"}),a.createElement("div",{className:"absolute inset-0 rounded-full ring-2 ring-indigo-500/50 animate-ping"})),a.createElement("span",{className:"text-sm font-medium"},"Recording in progress...")),a.createElement("canvas",{ref:u,width:800,height:40,className:"w-full h-10 rounded-lg shadow-inner"}),a.createElement("div",{className:"text-xs text-gray-500 text-center"},"Speak into your microphone to see the volume level")):a.createElement("div",{className:"relative",style:{minHeight:"100px"}},a.createElement("div",{ref:h,className:"absolute top-0 bottom-0 w-[2px] bg-red-500",style:{transform:"translateX(0)",zIndex:10,transition:"transform 0.25s cubic-bezier(0.4, 0, 0.2, 1)"}}),a.createElement("div",{ref:s})))}));function h(){const[e,t]=(0,a.useState)([]),[r,p]=(0,a.useState)(!1),[h,b]=(0,a.useState)(""),[y,E]=(0,a.useState)(""),[x,w]=(0,a.useState)(!1),[k,N]=(0,a.useState)(!1),[S,R]=(0,a.useState)(""),[C,A]=(0,a.useState)(!0),[O,P]=(0,a.useState)(!1),[z,T]=(0,a.useState)(!1),[j,F]=(0,a.useState)(null),D=(0,a.useRef)(null),I=(0,a.useRef)(null),W=(0,a.useRef)([]),M=(0,a.useRef)(null),L=(0,a.useRef)(null),_=(0,a.useRef)(null),q=(0,a.useCallback)((()=>{console.log("Waveform ready callback"),T(!0)}),[]);(0,a.useEffect)((()=>{B()}),[]);const B=async()=>{A(!0),F(null);try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach((e=>e.stop())),p(!0),await $()}catch(j){console.error("Error requesting permissions:",j),F("Could not access microphone. Please check your permissions.")}finally{A(!1)}},$=async()=>{try{const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind||"audiooutput"===e.kind));t(e);const r=e.find((e=>"audioinput"===e.kind)),a=e.find((e=>"audiooutput"===e.kind));r&&b(r.deviceId),a&&E(a.deviceId)}catch(j){console.error("Error updating device list:",j),F("Could not enumerate audio devices.")}},Z=()=>{console.log("Stopping recording..."),D.current&&x&&(D.current.requestData(),D.current.stop(),w(!1),console.log("Recording stopped"))};return C?a.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},a.createElement("div",{className:"flex items-center justify-center h-[60vh]"},"Please grant permission to access your microphone and speakers.",a.createElement(s.A,{className:"h-8 w-8 animate-spin text-primary"}))):r?a.createElement(f.A,{title:"Audio Device Checker"},a.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},a.createElement("h1",{className:"text-3xl font-bold mb-8"},"Audio Device Checker"),j&&a.createElement(g.Fc,{className:"mb-6 bg-red-50 border-red-200"},a.createElement(g.TN,{className:"text-red-800"},j)),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},a.createElement(n.Zp,null,a.createElement(n.aR,null,a.createElement(n.ZB,{className:"flex items-center gap-2"},a.createElement(c.A,{className:"h-5 w-5"}),"Microphones"),a.createElement(n.BT,null,"Select the microphone you want to test")),a.createElement(n.Wu,null,a.createElement(l.l6,{value:h,onValueChange:b},a.createElement(l.bq,null,a.createElement(l.yv,{placeholder:"Select a microphone"})),a.createElement(l.gC,null,e.filter((e=>"audioinput"===e.kind)).map((e=>a.createElement(l.eb,{key:e.deviceId,value:e.deviceId},e.label||`Microphone ${e.deviceId.substring(0,5)}...`))))))),a.createElement(n.Zp,null,a.createElement(n.aR,null,a.createElement(n.ZB,{className:"flex items-center gap-2"},a.createElement(i.A,{className:"h-5 w-5"}),"Speakers"),a.createElement(n.BT,null,"Select the speaker for playback")),a.createElement(n.Wu,null,a.createElement(l.l6,{value:y,onValueChange:E},a.createElement(l.bq,null,a.createElement(l.yv,{placeholder:"Select a speaker"})),a.createElement(l.gC,null,e.filter((e=>"audiooutput"===e.kind)).map((e=>a.createElement(l.eb,{key:e.deviceId,value:e.deviceId},e.label||`Speaker ${e.deviceId.substring(0,5)}...`)))))),a.createElement(n.wL,null,a.createElement(o.$,{variant:O?"destructive":"default",onClick:async()=>{if(O)return M.current&&(M.current.pause(),M.current.currentTime=0),void P(!1);try{F(null);const e=new Audio("https://li.me.kr/assets/audio/bgm.ogg");M.current=e,y&&"setSinkId"in e&&await e.setSinkId(y),e.play(),P(!0),e.onended=()=>{P(!1)}}catch(j){console.error("Error testing speaker:",j),F("Failed to test speaker. Please check your audio settings.")}},className:"flex items-center gap-2"},O?a.createElement(a.Fragment,null,a.createElement(u.A,{className:"h-4 w-4"}),"Stop Speaker Test"):a.createElement(a.Fragment,null,a.createElement(i.A,{className:"h-4 w-4"}),"Test Speaker"))))),a.createElement(n.Zp,null,a.createElement(n.aR,null,a.createElement(n.ZB,null,"Test Recording"),a.createElement(n.BT,null,"Record audio from your selected microphone and play it back through your selected speaker")),a.createElement(n.Wu,null,a.createElement("div",{className:"flex flex-col gap-4"},a.createElement("div",{className:"flex flex-wrap gap-4"},a.createElement(o.$,{variant:x?"destructive":"default",onClick:x?Z:async()=>{try{F(null),S&&(URL.revokeObjectURL(S),R("")),N(!1),_.current&&(_.current.pause(),_.current.seekTo(0)),W.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:{deviceId:h,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1,sampleRate:44100,sampleSize:16}}),t=e.getAudioTracks();if(0===t.length)throw new Error("No audio track available");const r=t[0];if("live"!==r.readyState)throw new Error("Audio track is not live");r.onended=()=>{console.error("Audio track ended unexpectedly"),F("Audio track ended unexpectedly"),Z()},r.onmute=()=>{console.error("Audio track muted"),F("Audio track was muted")},I.current=e,console.log("Got media stream:",e),console.log("Stream active:",e.active),console.log("Audio tracks:",t),console.log("Audio track settings:",r.getSettings());const a=new MediaRecorder(e,{mimeType:"audio/webm"});D.current=a,a.ondataavailable=e=>{e.data.size>0&&(W.current.push(e.data),console.log("Received audio chunk:",e.data.size,"bytes"),console.log("Total chunks:",W.current.length),console.log("Total size:",W.current.reduce(((e,t)=>e+t.size),0),"bytes"))},a.onstop=()=>{const t=new Blob(W.current,{type:"audio/webm"}),r=URL.createObjectURL(t);console.log("Created audio URL:",r),console.log("Final blob size:",t.size,"bytes"),R(r),e.getTracks().forEach((e=>{e.stop(),e.onended=null,e.onmute=null})),I.current=null},a.start(),console.log("MediaRecorder started"),w(!0),await new Promise((e=>setTimeout(e,100)))}catch(j){console.error("Error starting recording:",j),F(`Failed to start recording: ${j.message}`),I.current&&(I.current.getTracks().forEach((e=>e.stop())),I.current=null)}},disabled:!h,className:"flex items-center gap-2 transition-all duration-200 "+(x?"bg-red-600 hover:bg-red-700":"hover:bg-indigo-700")},x?a.createElement(a.Fragment,null,a.createElement(u.A,{className:"w-4 h-4"}),"Stop Recording"):a.createElement(a.Fragment,null,a.createElement(c.A,{className:"w-4 h-4"}),S?"Record Again":"Start Recording")),S&&!x&&a.createElement(a.Fragment,null,a.createElement(o.$,{variant:k?"destructive":"default",onClick:k?()=>{console.log("Stopping playback..."),L.current&&(L.current.pause(),L.current.currentTime=0,N(!1))}:()=>{if(!S||x)return console.error("Cannot play: Recording in progress"),void F("Cannot play recording at this time");console.log("Playing recording..."),L.current&&(L.current.src=S,L.current.play(),N(!0))},disabled:!z,className:"flex items-center gap-2 transition-all duration-200 "+(k?"bg-red-600 hover:bg-red-700":"hover:bg-indigo-700")},k?a.createElement(a.Fragment,null,a.createElement(u.A,{className:"w-4 h-4"}),"Stop Playback"):a.createElement(a.Fragment,null,a.createElement(d.A,{className:"w-4 h-4"}),"Play Recording")),a.createElement(o.$,{variant:"outline",onClick:()=>{if(S){const e=document.createElement("a");e.href=S,e.download="audio-recording.webm",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},className:"flex items-center gap-2 hover:bg-gray-100 transition-colors duration-200"},a.createElement(m.A,{className:"w-4 h-4"}),"Download Recording"))),!h&&a.createElement("div",{className:"text-sm text-gray-500 mt-2"},"Please select a microphone to start recording"),(S||x)&&a.createElement("div",{className:"mt-4"},a.createElement(v,{url:S,onReady:q,isRecording:x,audioStream:I.current||void 0,setIsPlaying:N,audioRef:L}),a.createElement(g.Fc,{className:"mt-4"},a.createElement(g.TN,null,x?"Recording in progress... Speak into your microphone to see the volume level.":k?"Playing your recording...":"Recording is ready for playback. Click the play button to hear your recording.")))))),a.createElement("audio",{ref:L,style:{display:"none"}}))):a.createElement("div",{className:"container mx-auto max-w-4xl py-12 px-4"},a.createElement("h1",{className:"text-3xl font-bold mb-8"},"Audio Device Checker"),a.createElement(n.Zp,null,a.createElement(n.aR,null,a.createElement(n.ZB,null,"Permission Required"),a.createElement(n.BT,null,"This tool needs permission to access your microphone and speakers.")),a.createElement(n.wL,null,a.createElement(o.$,{onClick:B},"Grant Permission"))))}v.displayName="Waveform"}}]);